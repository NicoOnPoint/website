<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Redirecting…</title>
  <meta name="robots" content="noindex" />
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; }
    .hint { opacity: .7; font-size: .95rem; }
  </style>
  <script>
    (function () {
      // 1) Allow manual override via query (?lang=en / ?lang=sv)
      const url = new URL(window.location.href);
      const qsLang = (url.searchParams.get("lang") || "").toLowerCase();

      // 2) Persisted choice from earlier (we set this when user switches language, optionally)
      const saved = (localStorage.getItem("site_lang") || "").toLowerCase();

      // 3) Detect from browser languages
      const langs = (navigator.languages && navigator.languages.length ? navigator.languages : [navigator.language || "en"])
        .map(l => (l || "").toLowerCase());

      // Decide target language
      let lang = "en"; // default
      const valid = new Set(["en", "sv"]);
      if (valid.has(qsLang))       lang = qsLang;
      else if (valid.has(saved))   lang = saved;
      else if (langs.some(l => l.startsWith("sv"))) lang = "sv";

      // Optional: remember explicit choice
      if (qsLang && valid.has(qsLang)) {
        try { localStorage.setItem("site_lang", qsLang); } catch (e) {}
      }

      // Build target URL and redirect (preserve query/hash, but drop ?lang=…)
      const base = lang === "sv" ? "/index-sv.html" : "/index-en.html";
      url.searchParams.delete("lang");
      const preserved = url.search ? url.search : "";
      const hash = url.hash || "";
      const target = base + preserved + hash;

      window.location.replace(target);
    })();
  </script>
</head>
<body>
  <h1>Redirecting…</h1>
  <p class="hint">
    Krijg je geen automatische doorverwijzing? Kies: 
    <a href="/index-en.html">English</a> • <a href="/index-sv.html">Svenska</a>
  </p>
  <noscript>
    <p>JavaScript staat uit. Ga verder naar 
      <a href="/index-en.html">English</a> of <a href="/index-sv.html">Svenska</a>.
    </p>
  </noscript>
</body>
</html>
